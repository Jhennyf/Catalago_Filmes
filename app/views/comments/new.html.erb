
<%= turbo_frame_tag "modal" do %>

  <div data-controller="dialog" data-dialog-open-value="true" data-action="click->dialog#backdropClose">
    
    <dialog data-dialog-target="dialog" class="bg-gray-800 rounded-lg shadow-lg p-0 max-w-lg w-full text-white">
      
      <div class="relative p-6">
        <button data-action="dialog#close" class="absolute top-3 right-3 text-gray-400 hover:text-white">
          <%= heroicon("x-mark", variant: :outline, options: { class: "w-6 h-6" }) %>
        </button>

        <h3 class="text-xl font-bold text-white mb-4">Deixe sua avaliação</h3>
        
        <%= simple_form_for [@movie, @comment], html: { class: "space-y-4" } do |f| %>
          <%= f.error_notification %>
          
          <% unless user_signed_in? %>
            <%= f.input :anonymous_name,
                  label: "Seu Nome (obrigatório para anônimo)",
                  required: true,
                  placeholder: "Usuário Anônimo",
                  input_html: { class: "w-full bg-gray-700 border-gray-600 rounded p-2 text-white" },
                  label_html: { class: "text-sm font-medium text-gray-300" } %>
          <% end %>

          <%= f.input :text,
                as: :text,
                label: "Comentário",
                required: true,
                placeholder: "O que você achou do filme?",
                input_html: { rows: 4, class: "w-full bg-gray-700 border-gray-600 rounded p-2 text-white" },
                label_html: { class: "text-sm font-medium text-gray-300" } %>
          
          <div class="flex items-center gap-4">
            <%= f.button :submit, "Enviar Avaliação", class: "bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-lg transition" %>
            
            <%# Botão de cancelar que usa a ação 'close' do controlador %>
            <button type="button" data-action="dialog#close" class="text-gray-400 hover:text-white">
              Cancelar
            </button>
          </div>
        <% end %>
      </div>
    </dialog>
  </div>
<% end %>